<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LootGen</title>
  <link rel="stylesheet" href="css/nodal.css">
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"
    integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
  <script src="js/defaults.js"></script>
  <script src="js/form.js"></script>
  <script src="js/lootgen.js"></script>
  <script src="js/nodal.js"></script>
</head>

<body>
  <main class="page">
    <h1>Secret Sauce LootGen</h1>
    <p>ARPG progression generator by <a href="https://chien-games.itch.io/" target="_blank">Charles Torris</a>.</p>
    <div class="hero">
      <p>This tool:</p>
      <ul>
        <li>Generates configurable XP and DPS curves up to your maximum level</li>
        <li>Generates all loot required for that progression</li>
        <li>Generates monsters consistent with that progression</li>
        <li>Simulates a level-by-level run in one click</li>
      </ul>
      <div class="hero-actions">
        <button id="compute-btn-top" type="button" class="compute-btn">Compute all levels</button>
      </div>
    </div>

    <form id="config-form" class="config-form" autocomplete="off">
      <div class="config-columns">
        <div class="config-column">
          <details class="form-section form-section-build-config" data-chart-group="config">
            <summary class="section-title">Game Configuration</summary>
            <div class="field">
              <label title="Slots available for items; affects which items can be rolled and equipped.">Equipment
                slots</label>
              <div class="tag-list" data-tags="equipment_slots"></div>
              <div class="tag-input">
                <button type="button" data-target="equipment_slots">Add</button>
              </div>
            </div>

            <div class="field">
              <label title="Damage and resistance types used for affixes and scaling.">Damage/resistances types</label>
              <div class="tag-list" data-tags="damage_types"></div>
              <div class="tag-input">
                <button type="button" data-target="damage_types">Add</button>
              </div>
            </div>

            <div class="field">
              <label title="Rarity rarities with unlock levels and affix counts.">rarities</label>
              <div class="tag-list" data-tags="rarities"></div>
              <div class="tag-input">
                <button type="button" data-target="rarities">Add</button>
              </div>
            </div>

            <div class="field">
              <label title="Item definitions (slot, size, affix cap, damage source flags).">Items</label>
              <div class="tag-list" data-tags="items"></div>
              <div class="tag-input">
                <button type="button" data-target="items">Add</button>
              </div>
            </div>

            <div class="field">
              <label title="Skills available for the build; used for display only here.">Skills</label>
              <div class="tag-list" data-tags="skills"></div>
              <div class="tag-input">
                <button type="button" data-target="skills">Add</button>
              </div>
            </div>
          </details>




        </div>
        <div class="config-column">
          <details class="form-section form-section-bases" data-chart-group="config">
            <summary class="section-title">Character</summary>
            <div class="field-grid">
              <div class="field">
                <label for="levels" title="Maximum character level simulated. Increases loops/loot generations.">Level
                  Max</label>
                <input type="number" id="levels" name="levels" min="1" max="200" step="1">
              </div>



              <div class="field">
                <label title="Starting min/max bounds for each attribute; impact starting stats and growth caps.">Base
                  stats</label>
                <table class="attr-table" style="width:200px">
                  <thead>
                    <tr>
                      <th></th>
                      <th>Min</th>
                      <th>Max</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr data-attr="force">
                      <td>Force</td>
                      <td><input type="number" min="10" max="200" step="1" class="attr-number" data-attr="force"
                          data-kind="min" placeholder="Min"></td>
                      <td><input type="number" min="10" max="200" step="1" class="attr-number" data-attr="force"
                          data-kind="max" placeholder="Max"></td>
                    </tr>
                    <tr data-attr="intelligence">
                      <td>Intelligence</td>
                      <td><input type="number" min="10" max="200" step="1" class="attr-number" data-attr="intelligence"
                          data-kind="min" placeholder="Min"></td>
                      <td><input type="number" min="10" max="200" step="1" class="attr-number" data-attr="intelligence"
                          data-kind="max" placeholder="Max"></td>
                    </tr>
                    <tr data-attr="dexterity">
                      <td>Dexterity</td>
                      <td><input type="number" min="10" max="200" step="1" class="attr-number" data-attr="dexterity"
                          data-kind="min" placeholder="Min"></td>
                      <td><input type="number" min="10" max="200" step="1" class="attr-number" data-attr="dexterity"
                          data-kind="max" placeholder="Max"></td>
                    </tr>
                  </tbody>
                </table>

              </div>

              <div class="field">
                <label for="unarmed-physical-damage"
                  title="Base physical damage with no weapon; scales with unarmed growth.">Unarmed physical
                  damage</label>
                <input type="number" id="unarmed-physical-damage" name="unarmed_physical_damage" min="0" step="1">
              </div>




              <div class="field">
                <label for="gain-per-level"
                  title="Flat stat gain per level applied to the selected stat progression model.">Stats Points given
                  per level</label>
                <input type="number" id="gain-per-level" name="gain_per_level" min="0" step="0.1">
              </div>
            </div>
          </details>
        </div>



      </div>

      <div class="chart-sections-row">
        <details class="form-section form-section-attack-speed" open style="background-color: #0f4b3c;"
          data-chart-group="core">
          <summary class="section-title">Attack Per Second (APS)</summary>
          <div class="field-grid">
            <div class="field full-span chart-field">
              <canvas id="attack-speed-chart" height="240"></canvas>
            </div>


            <div class="field range-field">
              <div class="range-pair">
                <span>APS from</span>
                <input type="number" id="attack-speed-min" name="attack_speed_min" min="0" step="0.01"
                  class="range-limit no-fader">
                <span>to</span>
                <input type="number" id="attack-speed-max" name="attack_speed_max" min="0" step="0.01"
                  class="range-limit no-fader">
              </div>
            </div>
            <div class="field">
              <label for="attack-speed-power" title="Curve exponent; 1 = linear.">APS curve</label>
              <input type="number" id="attack-speed-power" name="attack_speed_power_progression" min="0" step="0.1">
            </div>
            <div class="field">
              <input type="number" id="attack-speed-slots-auto" name="attack_speed_slots_auto" readonly
                class="hidden-input">
              <div>
                Character can equip up to <span id="attack-speed-slots-meta" class="red"></span> APS modifiers
              </div>
            </div>
          </div>
        </details>

        <details class="form-section form-section-flat-dmg" open style="    background-color: #ab3a11"
          data-chart-group="core">
          <summary class="section-title">Flat DMG</summary>
          <div class="field-grid">
            <div class="field full-span chart-field">

              <canvas id="flat-damage-chart" height="240"></canvas>
            </div>

            <div class="field range-field">
              <div class="range-pair">
                <span>FlatDmg from</span>
                <input type="number" id="flat-damage-min" name="flat_damage_min" min="0" step="1"
                  class="range-limit no-fader">
                <span>to</span>
                <input type="number" id="flat-damage-median" name="flat_damage_max" min="0" step="1"
                  class="range-limit no-fader">
              </div>
            </div>
            <div class="field-grid">
              <div class="field">
                <label for="flat-damage-power"
                  title="Exponent applied to level for flat dmg progression (lvl^power).">Flat dmg curve</label>
                <input type="number" id="flat-damage-power" name="flat_damage_power_progression" min="0" step="0.1">
              </div>
              <div class="field">
                <label for="flat-damage-jitter"
                  title="Random jitter applied around the median flat damage (as a percent).">Flat dmg jitter
                  (%)</label>
                <input type="number" id="flat-damage-jitter" name="flat_damage_jitter_pct" min="0" max="1" step="0.01">
              </div>

              <div class="field">
                <label for="flat-damage-onehand-ratio"
                  title="Multiplier applied to flat dmg for one-handed weapons.">One
                  hand ratio</label>
                <input type="number" id="flat-damage-onehand-ratio" name="flat_damage_onehand_ratio" min="0" max="1"
                  step="0.01">
              </div>
              <div class="field">
                <input type="number" id="flat-damage-slots-auto" name="flat_damage_equipement_slots_auto" readonly
                  class="hidden-input">
                <div>
                  Character can equip up to <span id="flat-damage-slots-meta" class="red"></span> items that source flat
                  dmg
                </div>
              </div>
            </div>

          </div>
        </details>

        <details class="form-section form-section-mod-dmg" open style="    background-color: #651212;"
          data-chart-group="core">
          <summary class="section-title">DMG modifiers</summary>
          <div class="field-grid">
            <div class="field full-span chart-field">

              <canvas id="mod-damage-chart" height="240"></canvas>
            </div>


            <div class="field range-field">
              <div class="range-pair">
                <span>Dmg mod from</span>
                <input type="number" id="mod-damage-min" name="mod_damage_min" min="0" step="1"
                  class="range-limit no-fader">
                <span>to</span>
                <input type="number" id="mod-damage-max" name="mod_damage_max" min="0" step="1"
                  class="range-limit no-fader">
              </div>
            </div>
            <div class="field-grid">
              <div class="field">
                <label for="mod-damage-power" title="Curve exponent; 1 = linear.">Final dmg curve</label>
                <input type="number" id="mod-damage-power" name="mod_damage_power_progression" min="0" step="0.1">
              </div>
              <div class="field">
                <label for="mod-damage-jitter"
                  title="Random jitter applied around the median final dmg (as a percent).">Final dmg jitter (%)</label>
                <input type="number" id="mod-damage-jitter" name="mod_damage_jitter_pct" min="0" max="1" step="0.01">
              </div>
              <div class="field">
                <input type="number" id="mod-damage-slots-auto" name="mod_damage_slots_auto" readonly
                  class="hidden-input">
                <div>
                  Character can equip up to <span id="mod-damage-slots-meta" class="red"></span> items using dmg
                  modifiers
                </div>
              </div>
            </div>
          </div>
        </details>

        <details class="form-section form-section-dps-planning" open style="background-color: #312e81;"
          data-chart-group="core">
          <summary class="section-title">DPS projection</summary>
          <div class="field-grid">
            <div class="field full-span chart-field">
              <canvas id="dps-planning-chart" height="240"></canvas>
            </div>
            <div class="field full-span">
              <details class="form-section" style="background-color: rgba(49,46,129,0.25);" open>
                <summary class="section-title">see DPS projection per level</summary>
                <div class="field full-span">
                  <div id="dps-planning-list" class="dps-planning-list"></div>
                </div>
              </details>
            </div>
          </div>
        </details>
        </details>
      </div>
      <div class="chart-sections-row future-row">
        <details class="form-section" style="background-color: #1c3d50;" data-chart-group="future" open>
          <summary class="section-title">XP Configuration</summary>
          <div class="field-grid">
            <div class="field full-span chart-field">

              <canvas id="xp-curve" height="240"></canvas>
            </div>
            <div class="field range-field">
              <div class="range-pair">
                <span> XP base</span>
                <input type="number" id="xp-base" name="xp_base" min="1" step="1" class="range-limit no-fader">
                <span>multiplier</span>
                <input type="number" id="xp-multiplier" name="xp_multiplier" min="0" step="0.1"
                  class="range-limit no-fader">
              </div>
            </div>
            <div class="field">
              <label for="xp-growth" title="Exponent applied to level for XP requirement.">XP growth</label>
              <input type="number" id="xp-growth" name="xp_growth" min="0" step="0.01">
            </div>
          </div>
          <details class="form-section xp-table" open>
            <summary class="section-title">see XP per level</summary>
            <div class="xp-levels" id="xp-levels"></div>
          </details>
        </details>
        <details class="form-section" style="background-color: #1f3c4e;" data-chart-group="future" open>
          <summary class="section-title">Level Time</summary>
          <div class="field-grid">
            <div class="field full-span chart-field">
              <canvas id="level-time-chart" height="240"></canvas>
            </div>

            <div class="field range-field">
              <div class="range-pair">
                <span>level length (s)</span>
                <input type="number" id="time-level-min" name="time_level_min" min="1" step="1"
                  class="range-limit no-fader">
                <span>to</span>
                <input type="number" id="time-level-max" name="time_level_max" min="1" step="1"
                  class="range-limit no-fader">
              </div>
            </div>

            <div class="field">
              <label for="time-level-curve" title="Curve exponent; 1 = linear.">Time Level Curve</label>
              <input type="number" id="time-level-curve" name="time_level_curve" min="0" step="0.1">
            </div>

            <div class="field">
              <div>
                Time to endgame : <span id="total-time-meta" class="red"></span> h
              </div>
            </div>
          </div>
        </details>
        <details class="form-section" style="background-color: #2a2b57;" data-chart-group="future" open>
          <summary class="section-title">Loot & Affixes</summary>
          <div class="field-grid">
            <div class="field">
              <label for="median-time-per-loot"
                title="Average seconds to obtain one loot; lower = more drops per level.">Median time per loot
                (s)</label>
              <input type="number" id="median-time-per-loot" name="median_time_per_loot" min="1" max="60" step="1">
            </div>

            <div class="field">
              <label for="additional-loot-factor" title="Multiplier on the number of loots rolled per level.">Loot
                augmentation per level</label>
              <input type="number" id="additional-loot-factor" name="additional_loot_factor" min="0" step="0.01">
            </div>

            <div class="field">
              <label for="affix-rarity-scale" title="Scales affix min/max with rarity (0 = none).">Affix rarity
                scale</label>
              <input type="number" id="affix-rarity-scale" name="affix_rarity_scale" min="0" step="0.01">
            </div>

            <div class="field">
              <label for="rarity-weight-growth"
                title="Adds weight to higher rarities per level; affects loot distribution.">Rarity weight
                growth</label>
              <input type="number" id="rarity-weight-growth" name="rarity_weight_growth" min="0" step="0.001">
            </div>

          </div>
        </details>
        <details class="form-section" style="background-color: #3b1f38;" data-chart-group="future" open>
          <summary class="section-title">Resist Balance</summary>
          <div class="field-grid">
            <div class="field full-span chart-field">
              <canvas id="resistance-chart" height="240"></canvas>
            </div>

            <div class="field range-field">
              <div class="range-pair">
                <span>Resist from</span>
                <input type="number" id="resistance-affix-min" name="resistance_affix_min" min="0" max="1" step="0.01"
                  class="range-limit no-fader">
                <span>to</span>
                <input type="number" id="resistance-affix-max" name="resistance_affix_max" min="0" max="1" step="0.01"
                  class="range-limit no-fader">
              </div>
            </div>

            <div class="field">
              <label for="resistance-curve" title="Curve exponent; 1 = linear.">Resistance curve</label>
              <input type="number" id="resistance-curve" name="resistance_curve" min="0" step="0.1">
            </div>

            <div class="field">
              <label for="resistance-jitter" title="Random jitter applied around the median resistance.">Resistance
                jitter</label>
              <input type="number" id="resistance-jitter" name="resistance_jitter" min="0" max="1" step="0.01">
            </div>

            <div class="field">
              <label for="resistance-cap" title="Maximum resistance cap percentage.">Resistance CAP %</label>
              <input type="number" id="resistance-cap" name="resistance_cap" min="0" max="100" step="1">
            </div>

            <div class="field">
              <input type="number" id="resistance-slots-auto" name="resistance_slots_auto" readonly
                class="hidden-input">
              <div>
                Character can equip up to <span id="resistance-slots-meta" class="red"></span> items with resistance
                affixes
              </div>
            </div>
          </div>
        </details>
      </div>
    </form>
    <section class="compute-panel">
      <div class="compute-panel-inner">
        <div class="compute-panel-grid">
          <div class="compute-panel-header">Simulation</div>

          <div class="compute-panel-column">
            <label for="stats-progression-model"
              title="How stat gains are distributed per level (balanced or favoring one stat).">Stats progression
              model</label>
            <select id="stats-progression-model" name="stats_progression_model">
              <option value="balanced">Balanced (random spread)</option>
              <option value="favorite_force">Favorite Force</option>
              <option value="favorite_intelligence">Favorite Intelligence</option>
              <option value="favorite_dexterity">Favorite Dexterity</option>
            </select>
          </div>

          <div class="compute-panel-column">
            <label for="desired-resistance"
              title="Target resistance percentage; capped by the resistance cap value.">Min Desired Resistances
              %</label>
            <input type="number" id="desired-resistance" name="desired_resistance" min="0" max="75" step="1"
              class="compute-input" data-fader="true">
          </div>

          <div class="compute-panel-column">
            <label for="generate-percent">
              How much loot is generated (%)
            </label>
            <input type="number" id="generate-percent" name="generate_percent" min="0" max="100" step="1"
              class="compute-input" data-fader="true">
          </div>

          <div class="compute-panel-column">
            <label>&nbsp;</label>
            <button id="compute-btn" type="button" class="compute-btn primary">Compute all levels</button>
          </div>
        </div>
      </div>
    </section>
    <div class="result-area">
      <div id="config-alert" class="config-alert" aria-live="polite"></div>
      <div id="compute-result" class="compute-result"></div>
    </div>
    <pre id="config-preview" class="config-preview"></pre>
  </main>

</body>

</html>